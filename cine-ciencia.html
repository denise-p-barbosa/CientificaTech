<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cine Ciência | CientificaTech</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* Correção forçada para o avatar não ficar gigante */
        .user-avatar-small {
            width: 50px !important;
            height: 50px !important;
            min-width: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid #555;
        }

        /* Animação suave ao trocar o texto */
        .fade-in {
            animation: fadeIn 0.4s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body class="cine-body">

    <header class="header">
        <div class="container nav-container">
            <div class="logo">CientificaTech</div> <nav>
                <ul class="nav-links">
                    <li><a href="index.html">Voltar ao Início</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <section class="cine-hero">
        <div class="hero-gradient">
            <div class="cine-hero-content">
                <span class="tag-hero">TOP 1 DA SEMANA</span>
                <h1>Oppenheimer</h1>
                <p class="hero-desc">A história do físico J. Robert Oppenheimer e seu papel no desenvolvimento da bomba atômica. Um estudo sobre ética, ciência e consequências.</p>
                <div class="hero-buttons">
                    <button class="btn-play"><i class="fas fa-play"></i> Assistir Trailer</button>
                    <button class="btn-info"><i class="fas fa-info-circle"></i> Mais Detalhes</button>
                </div>
            </div>
        </div>
    </section>

    <section class="cine-shelf">
        <h3 class="shelf-title">O que assistir <span class="highlight-blue">| Principais escolhas</span></h3>
        <div class="shelf-wrapper">
            <button class="shelf-arrow left" onclick="scrollShelf('main', -1)">&#10094;</button>
            <div class="movie-row" id="main-row">
                <p style="color:#666; padding:20px;">Carregando catálogo...</p>
            </div>
            <button class="shelf-arrow right" onclick="scrollShelf('main', 1)">&#10095;</button>
        </div>
    </section>

    <section class="cine-shelf user-recs-section">
        <h3 class="shelf-title">Top 10 Indicados <span class="highlight-gold">| Leitores do Canal</span></h3>
        <p class="section-subtitle">O ranking definitivo dos filmes que explodiram a mente da nossa comunidade.</p>

        <div class="user-picks-carousel-wrapper">
            <button class="pick-arrow left" onclick="scrollPicks(-1)">&#10094;</button>

            <div class="user-picks-track" id="picksTrack">
                </div>
            
            <button class="pick-arrow right" onclick="scrollPicks(1)">&#10095;</button>
        </div>

        <div class="review-box" id="reviewBox">
            <div class="review-content">
                <div class="review-header">
                    <img src="" class="user-avatar-small" id="rev-img-small">
                    <div>
                        <h4 id="rev-title">...</h4>
                        <div class="stars" id="rev-stars"></div>
                    </div>
                </div>
                <p id="rev-text">Clique em um filme acima para ver a opinião.</p>
                <span class="review-author" id="rev-author"></span>
            </div>
        </div>
    </section>

    <script src="dados-filmes.js"></script>

    <script>
        // --- FUNÇÃO PARA CRIAR AS BOLINHAS AUTOMATICAMENTE ---
        function renderUserPicks() {
            const track = document.getElementById('picksTrack');
            track.innerHTML = ''; // Garante que tá vazio

            // Para cada filme no seu arquivo dados-filmes.js...
            catalogoCuradoria.forEach((item, index) => {
                const html = `
                <div class="user-pick-item" onclick="updateReview(${index})">
                    <div class="circle-img-wrapper">
                        <img src="${item.imagem}" alt="${item.titulo}">
                        <div class="rank-badge">${index + 1}</div>
                    </div>
                    <span class="pick-name">${item.titulo}</span>
                </div>
                `;
                track.innerHTML += html;
            });

            // Carrega o primeiro filme automaticamente na caixa de texto
            updateReview(0);
        }

        // --- FUNÇÃO DE CLIQUE (ATUALIZAR DEPOIMENTO) ---
        function updateReview(index) {
            const data = catalogoCuradoria[index]; // Pega do seu arquivo externo
            if (!data) return;

            const box = document.getElementById('reviewBox');
            
            // Animação de troca
            box.classList.remove('fade-in');
            void box.offsetWidth; 

            // Atualiza os textos na tela
            document.getElementById('rev-title').innerText = data.titulo;
            document.getElementById('rev-stars').innerText = data.estrelas;
            document.getElementById('rev-text').innerText = `"${data.depoimento}"`;
            document.getElementById('rev-author').innerHTML = `Indicado por: <strong>${data.autor}</strong>`;
            
            // Atualiza também a fotinha pequena dentro da caixa
            document.getElementById('rev-img-small').src = "https://cdn-icons-png.flaticon.com/512/149/149071.png"; // Avatar padrão

            box.classList.add('fade-in');
        }

        // --- FUNÇÃO SCROLL ---
        function scrollPicks(direction) {
            document.getElementById('picksTrack').scrollBy({ left: direction * 300, behavior: 'smooth' });
        }

        // --- SCRIPT API TMDB (Mantido para a lista de cima) ---
        const API_KEY = '15d2ea6d0dc1d476efbca3eba2b9bbfb'; 
        const BASE_URL = 'https://api.themoviedb.org/3';
        const IMAGE_URL = 'https://image.tmdb.org/t/p/w500';
        
        async function fetchMovies() {
            const container = document.getElementById('main-row');
            if(!container) return;
            try {
                const res = await fetch(`${BASE_URL}/discover/movie?api_key=${API_KEY}&sort_by=popularity.desc&vote_count.gte=2000&language=pt-BR`);
                const data = await res.json();
                container.innerHTML = ''; 
                data.results.forEach(movie => {
                    const poster = movie.poster_path ? `${IMAGE_URL}${movie.poster_path}` : 'https://via.placeholder.com/300x450';
                    const rating = movie.vote_average.toFixed(1);
                    container.innerHTML += `
                        <div class="prime-card">
                            <div class="poster-area"><img src="${poster}"><button class="add-btn">+</button></div>
                            <div class="movie-info">
                                <div class="rating-row"><i class="fas fa-star star-icon"></i><span class="rating-num">${rating}</span></div>
                                <h4>${movie.title.length > 20 ? movie.title.substring(0, 20) + '...' : movie.title}</h4>
                                <div class="card-buttons"><a href="#" class="btn-card-trailer">Trailer</a><button class="btn-card-info">i</button></div>
                            </div>
                        </div>`;
                });
            } catch (error) { console.error("Erro API:", error); }
        }
        function scrollShelf(id, dir) { document.getElementById(id+'-row').scrollBy({left: dir*600, behavior:'smooth'}); }

        // INICIALIZA TUDO
        fetchMovies();      // Carrega API
        renderUserPicks();  // Carrega sua Curadoria
    </script>

</body>
</html>